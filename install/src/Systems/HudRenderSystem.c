/* HudRenderSystem.c generated by valac 0.34.4, the Vala compiler
 * generated from HudRenderSystem.gs, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <Entitas.h>
#include <Bosco.h>
#include <SDL2/SDL_render.h>
#include <SDL2/SDL_pixels.h>
#include <stdlib.h>
#include <string.h>


#define SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM (shmup_warz_hud_render_system_get_type ())
#define SHMUP_WARZ_HUD_RENDER_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, ShmupWarzHudRenderSystem))
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, ShmupWarzHudRenderSystemClass))
#define SHMUP_WARZ_IS_HUD_RENDER_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM))
#define SHMUP_WARZ_IS_HUD_RENDER_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM))
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, ShmupWarzHudRenderSystemClass))

typedef struct _ShmupWarzHudRenderSystem ShmupWarzHudRenderSystem;
typedef struct _ShmupWarzHudRenderSystemClass ShmupWarzHudRenderSystemClass;
typedef struct _ShmupWarzHudRenderSystemPrivate ShmupWarzHudRenderSystemPrivate;

#define SHMUP_WARZ_TYPE_GAME (shmup_warz_game_get_type ())
#define SHMUP_WARZ_GAME(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SHMUP_WARZ_TYPE_GAME, ShmupWarzGame))
#define SHMUP_WARZ_GAME_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SHMUP_WARZ_TYPE_GAME, ShmupWarzGameClass))
#define SHMUP_WARZ_IS_GAME(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SHMUP_WARZ_TYPE_GAME))
#define SHMUP_WARZ_IS_GAME_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SHMUP_WARZ_TYPE_GAME))
#define SHMUP_WARZ_GAME_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SHMUP_WARZ_TYPE_GAME, ShmupWarzGameClass))

typedef struct _ShmupWarzGame ShmupWarzGame;
typedef struct _ShmupWarzGameClass ShmupWarzGameClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

#define SHMUP_WARZ_TYPE_LAYER (shmup_warz_layer_get_type ())

struct _ShmupWarzHudRenderSystem {
	GObject parent_instance;
	ShmupWarzHudRenderSystemPrivate * priv;
};

struct _ShmupWarzHudRenderSystemClass {
	GObjectClass parent_class;
};

struct _ShmupWarzHudRenderSystemPrivate {
	ShmupWarzGame* _game;
	EntitasWorld* _world;
	BoscoFont* _font;
	BoscoSprite* _activeEntities;
	BoscoSprite* _totalRetained;
	BoscoSprite* _totalReusable;
	SDL_Renderer* _renderer;
};

typedef enum  {
	SHMUP_WARZ_LAYER_DEFAULT,
	SHMUP_WARZ_LAYER_BACKGROUND,
	SHMUP_WARZ_LAYER_TEXT,
	SHMUP_WARZ_LAYER_LIVES,
	SHMUP_WARZ_LAYER_MINES,
	SHMUP_WARZ_LAYER_ACTORS_1,
	SHMUP_WARZ_LAYER_ACTORS_2,
	SHMUP_WARZ_LAYER_ACTORS_3,
	SHMUP_WARZ_LAYER_PLAYER,
	SHMUP_WARZ_LAYER_BULLET,
	SHMUP_WARZ_LAYER_PARTICLE,
	SHMUP_WARZ_LAYER_HUD
} ShmupWarzLayer;


static gpointer shmup_warz_hud_render_system_parent_class = NULL;
static EntitasISystemIface* shmup_warz_hud_render_system_entitas_isystem_parent_iface = NULL;
static EntitasISetWorldIface* shmup_warz_hud_render_system_entitas_iset_world_parent_iface = NULL;
static EntitasIInitializeSystemIface* shmup_warz_hud_render_system_entitas_iinitialize_system_parent_iface = NULL;
static EntitasIExecuteSystemIface* shmup_warz_hud_render_system_entitas_iexecute_system_parent_iface = NULL;

GType shmup_warz_hud_render_system_get_type (void) G_GNUC_CONST;
GType shmup_warz_game_get_type (void) G_GNUC_CONST;
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, ShmupWarzHudRenderSystemPrivate))
enum  {
	SHMUP_WARZ_HUD_RENDER_SYSTEM_DUMMY_PROPERTY
};
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_ACTIVE_ENTITIES "Active entities:         %3d"
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_RETAINED "Total reusable:          %3d"
#define SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_REUSABLE "Total retained:          %3d"
ShmupWarzHudRenderSystem* shmup_warz_hud_render_system_new (ShmupWarzGame* game);
ShmupWarzHudRenderSystem* shmup_warz_hud_render_system_construct (GType object_type, ShmupWarzGame* game);
static void shmup_warz_hud_render_system_real_setWorld (EntitasISetWorld* base, EntitasWorld* world);
static void shmup_warz_hud_render_system_real_initialize (EntitasIInitializeSystem* base);
BoscoSprite* shmup_warz_hud_render_system_createText (ShmupWarzHudRenderSystem* self, gint x, gint y, const gchar* text);
static void shmup_warz_hud_render_system_real_execute (EntitasIExecuteSystem* base);
void shmup_warz_hud_render_system_setText (ShmupWarzHudRenderSystem* self, BoscoSprite* sprite, const gchar* text);
GType shmup_warz_layer_get_type (void) G_GNUC_CONST;
static void shmup_warz_hud_render_system_finalize (GObject* obj);

const SDL_Color SHMUP_WARZ_HUD_RENDER_SYSTEM_WHITE = {(guint8) 250, (guint8) 250, (guint8) 250};

static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


ShmupWarzHudRenderSystem* shmup_warz_hud_render_system_construct (GType object_type, ShmupWarzGame* game) {
	ShmupWarzHudRenderSystem * self = NULL;
	ShmupWarzGame* _tmp0_ = NULL;
	ShmupWarzGame* _tmp1_ = NULL;
	ShmupWarzGame* _tmp2_ = NULL;
	SDL_Renderer* _tmp3_ = NULL;
	g_return_val_if_fail (game != NULL, NULL);
	self = (ShmupWarzHudRenderSystem*) g_object_new (object_type, NULL);
	_tmp0_ = game;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_game);
	self->priv->_game = _tmp1_;
	_tmp2_ = self->priv->_game;
	_tmp3_ = ((BoscoAbstractGame*) _tmp2_)->renderer;
	self->priv->_renderer = _tmp3_;
	return self;
}


ShmupWarzHudRenderSystem* shmup_warz_hud_render_system_new (ShmupWarzGame* game) {
	return shmup_warz_hud_render_system_construct (SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, game);
}


static void shmup_warz_hud_render_system_real_setWorld (EntitasISetWorld* base, EntitasWorld* world) {
	ShmupWarzHudRenderSystem * self;
	EntitasWorld* _tmp0_ = NULL;
	EntitasWorld* _tmp1_ = NULL;
	self = (ShmupWarzHudRenderSystem*) base;
	g_return_if_fail (world != NULL);
	_tmp0_ = world;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_world);
	self->priv->_world = _tmp1_;
}


static void shmup_warz_hud_render_system_real_initialize (EntitasIInitializeSystem* base) {
	ShmupWarzHudRenderSystem * self;
	ShmupWarzGame* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	BoscoFont* _tmp2_ = NULL;
	BoscoFont* _tmp3_ = NULL;
	ShmupWarzGame* _tmp4_ = NULL;
	GPtrArray* _tmp5_ = NULL;
	EntitasWorld* _tmp6_ = NULL;
	gint _tmp7_ = 0;
	gint _tmp8_ = 0;
	gchar* _tmp9_ = NULL;
	gchar* _tmp10_ = NULL;
	BoscoSprite* _tmp11_ = NULL;
	BoscoSprite* _tmp12_ = NULL;
	BoscoSprite* _tmp13_ = NULL;
	ShmupWarzGame* _tmp14_ = NULL;
	GPtrArray* _tmp15_ = NULL;
	EntitasWorld* _tmp16_ = NULL;
	gint _tmp17_ = 0;
	gint _tmp18_ = 0;
	gchar* _tmp19_ = NULL;
	gchar* _tmp20_ = NULL;
	BoscoSprite* _tmp21_ = NULL;
	BoscoSprite* _tmp22_ = NULL;
	BoscoSprite* _tmp23_ = NULL;
	ShmupWarzGame* _tmp24_ = NULL;
	GPtrArray* _tmp25_ = NULL;
	EntitasWorld* _tmp26_ = NULL;
	gint _tmp27_ = 0;
	gint _tmp28_ = 0;
	gchar* _tmp29_ = NULL;
	gchar* _tmp30_ = NULL;
	BoscoSprite* _tmp31_ = NULL;
	BoscoSprite* _tmp32_ = NULL;
	BoscoSprite* _tmp33_ = NULL;
	self = (ShmupWarzHudRenderSystem*) base;
	_tmp0_ = self->priv->_game;
	_tmp1_ = ((BoscoAbstractGame*) _tmp0_)->defaultFont;
	_tmp2_ = bosco_font_fromFile (_tmp1_, 16);
	_g_object_unref0 (self->priv->_font);
	self->priv->_font = _tmp2_;
	_tmp3_ = self->priv->_font;
	if (_tmp3_ == NULL) {
		g_print ("Failed to load font\n");
	}
	_tmp4_ = self->priv->_game;
	_tmp5_ = ((BoscoAbstractGame*) _tmp4_)->sprites;
	_tmp6_ = self->priv->_world;
	_tmp7_ = entitas_world_get_count (_tmp6_);
	_tmp8_ = _tmp7_;
	_tmp9_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_ACTIVE_ENTITIES, _tmp8_);
	_tmp10_ = _tmp9_;
	_tmp11_ = shmup_warz_hud_render_system_createText (self, 0, 40, _tmp10_);
	_g_object_unref0 (self->priv->_activeEntities);
	self->priv->_activeEntities = _tmp11_;
	_tmp12_ = self->priv->_activeEntities;
	_tmp13_ = _g_object_ref0 (_tmp12_);
	g_ptr_array_add (_tmp5_, _tmp13_);
	_g_free0 (_tmp10_);
	_tmp14_ = self->priv->_game;
	_tmp15_ = ((BoscoAbstractGame*) _tmp14_)->sprites;
	_tmp16_ = self->priv->_world;
	_tmp17_ = entitas_world_get_reusableEntitiesCount (_tmp16_);
	_tmp18_ = _tmp17_;
	_tmp19_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_RETAINED, _tmp18_);
	_tmp20_ = _tmp19_;
	_tmp21_ = shmup_warz_hud_render_system_createText (self, 0, 60, _tmp20_);
	_g_object_unref0 (self->priv->_totalRetained);
	self->priv->_totalRetained = _tmp21_;
	_tmp22_ = self->priv->_totalRetained;
	_tmp23_ = _g_object_ref0 (_tmp22_);
	g_ptr_array_add (_tmp15_, _tmp23_);
	_g_free0 (_tmp20_);
	_tmp24_ = self->priv->_game;
	_tmp25_ = ((BoscoAbstractGame*) _tmp24_)->sprites;
	_tmp26_ = self->priv->_world;
	_tmp27_ = entitas_world_get_retainedEntitiesCount (_tmp26_);
	_tmp28_ = _tmp27_;
	_tmp29_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_REUSABLE, _tmp28_);
	_tmp30_ = _tmp29_;
	_tmp31_ = shmup_warz_hud_render_system_createText (self, 0, 80, _tmp30_);
	_g_object_unref0 (self->priv->_totalReusable);
	self->priv->_totalReusable = _tmp31_;
	_tmp32_ = self->priv->_totalReusable;
	_tmp33_ = _g_object_ref0 (_tmp32_);
	g_ptr_array_add (_tmp25_, _tmp33_);
	_g_free0 (_tmp30_);
}


static void shmup_warz_hud_render_system_real_execute (EntitasIExecuteSystem* base) {
	ShmupWarzHudRenderSystem * self;
	BoscoSprite* _tmp0_ = NULL;
	EntitasWorld* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	gint _tmp3_ = 0;
	gchar* _tmp4_ = NULL;
	gchar* _tmp5_ = NULL;
	BoscoSprite* _tmp6_ = NULL;
	EntitasWorld* _tmp7_ = NULL;
	gint _tmp8_ = 0;
	gint _tmp9_ = 0;
	gchar* _tmp10_ = NULL;
	gchar* _tmp11_ = NULL;
	BoscoSprite* _tmp12_ = NULL;
	EntitasWorld* _tmp13_ = NULL;
	gint _tmp14_ = 0;
	gint _tmp15_ = 0;
	gchar* _tmp16_ = NULL;
	gchar* _tmp17_ = NULL;
	self = (ShmupWarzHudRenderSystem*) base;
	_tmp0_ = self->priv->_activeEntities;
	_tmp1_ = self->priv->_world;
	_tmp2_ = entitas_world_get_count (_tmp1_);
	_tmp3_ = _tmp2_;
	_tmp4_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_ACTIVE_ENTITIES, _tmp3_);
	_tmp5_ = _tmp4_;
	shmup_warz_hud_render_system_setText (self, _tmp0_, _tmp5_);
	_g_free0 (_tmp5_);
	_tmp6_ = self->priv->_totalRetained;
	_tmp7_ = self->priv->_world;
	_tmp8_ = entitas_world_get_retainedEntitiesCount (_tmp7_);
	_tmp9_ = _tmp8_;
	_tmp10_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_RETAINED, _tmp9_);
	_tmp11_ = _tmp10_;
	shmup_warz_hud_render_system_setText (self, _tmp6_, _tmp11_);
	_g_free0 (_tmp11_);
	_tmp12_ = self->priv->_totalReusable;
	_tmp13_ = self->priv->_world;
	_tmp14_ = entitas_world_get_reusableEntitiesCount (_tmp13_);
	_tmp15_ = _tmp14_;
	_tmp16_ = g_strdup_printf (SHMUP_WARZ_HUD_RENDER_SYSTEM_TOTAL_REUSABLE, _tmp15_);
	_tmp17_ = _tmp16_;
	shmup_warz_hud_render_system_setText (self, _tmp12_, _tmp17_);
	_g_free0 (_tmp17_);
}


BoscoSprite* shmup_warz_hud_render_system_createText (ShmupWarzHudRenderSystem* self, gint x, gint y, const gchar* text) {
	BoscoSprite* result = NULL;
	BoscoSprite* sprite = NULL;
	SDL_Renderer* _tmp0_ = NULL;
	BoscoFont* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	BoscoSprite* _tmp3_ = NULL;
	gint _tmp4_ = 0;
	gint _tmp5_ = 0;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (text != NULL, NULL);
	_tmp0_ = self->priv->_renderer;
	_tmp1_ = self->priv->_font;
	_tmp2_ = text;
	_tmp3_ = bosco_sprite_fromRenderedText (_tmp0_, _tmp1_, _tmp2_, SHMUP_WARZ_HUD_RENDER_SYSTEM_WHITE);
	sprite = _tmp3_;
	_tmp4_ = x;
	sprite->x = _tmp4_;
	_tmp5_ = y;
	sprite->y = _tmp5_;
	sprite->layer = (gint) SHMUP_WARZ_LAYER_HUD;
	sprite->centered = FALSE;
	result = sprite;
	return result;
}


void shmup_warz_hud_render_system_setText (ShmupWarzHudRenderSystem* self, BoscoSprite* sprite, const gchar* text) {
	BoscoSprite* _tmp0_ = NULL;
	SDL_Renderer* _tmp1_ = NULL;
	BoscoFont* _tmp2_ = NULL;
	TTF_Font* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (sprite != NULL);
	g_return_if_fail (text != NULL);
	_tmp0_ = sprite;
	_tmp1_ = self->priv->_renderer;
	_tmp2_ = self->priv->_font;
	_tmp3_ = _tmp2_->innerFont;
	_tmp4_ = text;
	bosco_sprite_setText (_tmp0_, _tmp1_, _tmp3_, _tmp4_, SHMUP_WARZ_HUD_RENDER_SYSTEM_WHITE);
}


static void shmup_warz_hud_render_system_class_init (ShmupWarzHudRenderSystemClass * klass) {
	shmup_warz_hud_render_system_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (ShmupWarzHudRenderSystemPrivate));
	G_OBJECT_CLASS (klass)->finalize = shmup_warz_hud_render_system_finalize;
}


static void shmup_warz_hud_render_system_entitas_isystem_interface_init (EntitasISystemIface * iface) {
	shmup_warz_hud_render_system_entitas_isystem_parent_iface = g_type_interface_peek_parent (iface);
}


static void shmup_warz_hud_render_system_entitas_iset_world_interface_init (EntitasISetWorldIface * iface) {
	shmup_warz_hud_render_system_entitas_iset_world_parent_iface = g_type_interface_peek_parent (iface);
	iface->setWorld = (void (*)(EntitasISetWorld*, EntitasWorld*)) shmup_warz_hud_render_system_real_setWorld;
}


static void shmup_warz_hud_render_system_entitas_iinitialize_system_interface_init (EntitasIInitializeSystemIface * iface) {
	shmup_warz_hud_render_system_entitas_iinitialize_system_parent_iface = g_type_interface_peek_parent (iface);
	iface->initialize = (void (*)(EntitasIInitializeSystem*)) shmup_warz_hud_render_system_real_initialize;
}


static void shmup_warz_hud_render_system_entitas_iexecute_system_interface_init (EntitasIExecuteSystemIface * iface) {
	shmup_warz_hud_render_system_entitas_iexecute_system_parent_iface = g_type_interface_peek_parent (iface);
	iface->execute = (void (*)(EntitasIExecuteSystem*)) shmup_warz_hud_render_system_real_execute;
}


static void shmup_warz_hud_render_system_instance_init (ShmupWarzHudRenderSystem * self) {
	self->priv = SHMUP_WARZ_HUD_RENDER_SYSTEM_GET_PRIVATE (self);
}


static void shmup_warz_hud_render_system_finalize (GObject* obj) {
	ShmupWarzHudRenderSystem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SHMUP_WARZ_TYPE_HUD_RENDER_SYSTEM, ShmupWarzHudRenderSystem);
	_g_object_unref0 (self->priv->_game);
	_g_object_unref0 (self->priv->_world);
	_g_object_unref0 (self->priv->_font);
	_g_object_unref0 (self->priv->_activeEntities);
	_g_object_unref0 (self->priv->_totalRetained);
	_g_object_unref0 (self->priv->_totalReusable);
	G_OBJECT_CLASS (shmup_warz_hud_render_system_parent_class)->finalize (obj);
}


GType shmup_warz_hud_render_system_get_type (void) {
	static volatile gsize shmup_warz_hud_render_system_type_id__volatile = 0;
	if (g_once_init_enter (&shmup_warz_hud_render_system_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ShmupWarzHudRenderSystemClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) shmup_warz_hud_render_system_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ShmupWarzHudRenderSystem), 0, (GInstanceInitFunc) shmup_warz_hud_render_system_instance_init, NULL };
		static const GInterfaceInfo entitas_isystem_info = { (GInterfaceInitFunc) shmup_warz_hud_render_system_entitas_isystem_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo entitas_iset_world_info = { (GInterfaceInitFunc) shmup_warz_hud_render_system_entitas_iset_world_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo entitas_iinitialize_system_info = { (GInterfaceInitFunc) shmup_warz_hud_render_system_entitas_iinitialize_system_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		static const GInterfaceInfo entitas_iexecute_system_info = { (GInterfaceInitFunc) shmup_warz_hud_render_system_entitas_iexecute_system_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		GType shmup_warz_hud_render_system_type_id;
		shmup_warz_hud_render_system_type_id = g_type_register_static (G_TYPE_OBJECT, "ShmupWarzHudRenderSystem", &g_define_type_info, 0);
		g_type_add_interface_static (shmup_warz_hud_render_system_type_id, ENTITAS_TYPE_ISYSTEM, &entitas_isystem_info);
		g_type_add_interface_static (shmup_warz_hud_render_system_type_id, ENTITAS_TYPE_ISET_WORLD, &entitas_iset_world_info);
		g_type_add_interface_static (shmup_warz_hud_render_system_type_id, ENTITAS_TYPE_IINITIALIZE_SYSTEM, &entitas_iinitialize_system_info);
		g_type_add_interface_static (shmup_warz_hud_render_system_type_id, ENTITAS_TYPE_IEXECUTE_SYSTEM, &entitas_iexecute_system_info);
		g_once_init_leave (&shmup_warz_hud_render_system_type_id__volatile, shmup_warz_hud_render_system_type_id);
	}
	return shmup_warz_hud_render_system_type_id__volatile;
}



